## **何をしているか**

- 画像を **左右反転**する
    
- **確率 0.5（50%）** で実行される（デフォルト）
    

  

つまり

👉 同じ画像でも

- 元のまま
    
- 左右反転したもの
    

  

をランダムに見せる

---

## **なぜ必要なのか**

  

### **① 左右は意味を持たない（多くの画像で）**

  

乳がん画像（顕微鏡・組織画像）では、

- 左向き / 右向きで **意味は変わらない**
    
- 病変の「形」「質感」「構造」が重要
    

  

👉 だから **左右反転は安全なデータ拡張**

---

### **② 過学習を防ぐ**

- 左右反転で **入力のバリエーションが2倍**
    
- 同じ画像を暗記しにくくなる
    

  

👉 汎化性能アップ

---

### **③ 実運用で起きる“左右違い”に強くする**

  

実データでは：

- 撮影時の向き
    
- 切り出し方向
    
- 前処理の違い
    

  

などで左右が反転していることが普通にあります。

  

👉 **どっちでも同じ判定を出せるモデル**にする

---

## **なぜ VerticalFlip（上下反転）じゃないの？**

  

これは重要なポイント。

  

### **水平反転（HorizontalFlip）**

- 多くの自然画像・医療画像で **意味が変わらない**
    
- 比較的安全
    

  

### **垂直反転（VerticalFlip）**

- 医療画像では
    
    - 撮影方向
        
    - 解剖学的上下
        
    - 重力方向
        
        が意味を持つ場合がある
        
    

  

👉 **安易に入れると危険**

  

乳腺組織画像では

**VerticalFlip は慎重** or **使わない**のが一般的です。

---

## **RandomRotation と被らない？**

  

いい質問です。

- RandomRotation(±30°)
    
    - 回転に対する不変性
        
    
- RandomHorizontalFlip
    
    - 鏡像に対する不変性
        
    

  

👉 **別の種類の変換**なので意味がある

---

## **学習・評価での使い分け**

  

### **学習時（train）**

```
transforms.RandomHorizontalFlip(),
```

✅ 入れる

  

### **検証・テスト（val/test）**

入れない

❌ 毎回違う入力になると評価できない

---

## **もし消したらどうなる？**

- 学習は安定するかも
    
- でも
    
    - 過学習しやすい
        
    - 左右の向きに弱くなる
        
    
- 実データで精度が落ちる可能性
    

---

## **まとめ**

- RandomHorizontalFlip は
    
    👉 **「左右は意味を持たない」という知識をモデルに教える処理**
    
- 医療画像でも比較的安全な拡張
    
- 過学習防止・汎化向上に効く
    

---

次に考えると面白いのは：

[[- **flip の確率を 0.5 → 0.2 にしたら？**]]
    
- **左右が意味を持つデータだったらどうする？**
    
- **左右反転で病変が消えるケースはない？**
    

  

この辺も精度設計に直結します。